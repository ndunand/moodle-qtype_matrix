<?xml version="1.0" encoding="UTF-8" ?>
<XMLDB PATH="question/type/matrix/db" VERSION="20250722" COMMENT="XMLDB file for Moodle question/type/matrix"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="../../../../lib/xmldb/xmldb.xsd"
>
  <TABLES>
    <TABLE NAME="qtype_matrix" COMMENT="Contains info about matrix questions">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="questionid" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="FK to question table"/>
        <FIELD NAME="grademethod" TYPE="text" NOTNULL="true" SEQUENCE="false" COMMENT="what the grading method is for this question.  Should match a constant in phpcode, QTYPE_MATRIX_GRADING_*"/>
        <FIELD NAME="multiple" TYPE="int" LENGTH="1" NOTNULL="true" DEFAULT="1" SEQUENCE="false" COMMENT="whether this question is allowed multiple choice (eg checkboxes rather than radio buttons)"/>
        <FIELD NAME="usedndui" TYPE="int" LENGTH="1" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Use drag and drop UI?"/>
        <FIELD NAME="shuffleanswers" TYPE="int" LENGTH="1" NOTNULL="true" DEFAULT="1" SEQUENCE="false" COMMENT="Shuffle answer statements?"/>
        <FIELD NAME="renderer" TYPE="text" NOTNULL="true" SEQUENCE="false" COMMENT="the type of renderer to use to draw the student ui (eg, could be drag and drop later, but is 'matrix' for now).  should match a class: qtype_matrix_renderer_{$value}"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="questionidfk" TYPE="foreign" FIELDS="questionid" REFTABLE="question" REFFIELDS="id" COMMENT="fk to question table"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="qtype_matrix_cols" COMMENT="Column definitions for the question matrix">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="matrixid" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="fk to qtype_matrix table"/>
        <FIELD NAME="shorttext" TYPE="text" NOTNULL="true" SEQUENCE="false" COMMENT="short word to fit in the matrix"/>
        <FIELD NAME="description" TYPE="text" NOTNULL="false" SEQUENCE="false" COMMENT="longer text to explain shorttext."/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="matrixidfk" TYPE="foreign" FIELDS="matrixid" REFTABLE="qtype_matrix" REFFIELDS="id" COMMENT="fk to qtype_matrix table."/>
      </KEYS>
    </TABLE>
    <TABLE NAME="qtype_matrix_rows" COMMENT="Row definitions for the question matrix">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="matrixid" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="fk to qtype_matrix table"/>
        <FIELD NAME="shorttext" TYPE="text" NOTNULL="true" SEQUENCE="false" COMMENT="short word to fit in the matrix"/>
        <FIELD NAME="description" TYPE="text" NOTNULL="false" SEQUENCE="false" COMMENT="longer text to explain shorttext."/>
        <FIELD NAME="feedback" TYPE="text" NOTNULL="false" SEQUENCE="false" COMMENT="feedback."/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="matrixidfk" TYPE="foreign" FIELDS="matrixid" REFTABLE="qtype_matrix" REFFIELDS="id" COMMENT="fk to qtype_matrix table."/>
      </KEYS>
    </TABLE>
    <TABLE NAME="qtype_matrix_weights" COMMENT="weightings for the cells if necessary.">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="rowid" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="fk to qtype_matrix_rows"/>
        <FIELD NAME="colid" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="fk to qtype_matrix_cols"/>
        <FIELD NAME="weight" TYPE="float" LENGTH="4" NOTNULL="true" DEFAULT="0" SEQUENCE="false" DECIMALS="3" COMMENT="percentage weighting for this cell."/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="rowidfk" TYPE="foreign" FIELDS="rowid" REFTABLE="qtype_matrix_rows" REFFIELDS="id" COMMENT="fk to qtype_matrix_rows"/>
        <KEY NAME="colidfk" TYPE="foreign" FIELDS="colid" REFTABLE="qtype_matrix_cols" REFFIELDS="id" COMMENT="fk to qtype_matrix_cols"/>
      </KEYS>
    </TABLE>
  </TABLES>
</XMLDB>
